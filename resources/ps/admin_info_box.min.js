$(function(){"use strict";function n(){s.hide(),$(document).click(function(){var n=$(this);s.is(":visible")&&(n===s||0!==n.parents("#admin_info_wrapper").length||n.hasClass("admin_info_box_button")||s.removeClass("active"))}),$(".admin_info_box").each(function(){if($(this).not(".hidden").length>0&&$(".admin_info_box_button").addClass("active"),!$(this).hasClass("read")&&!$(this).hasClass("hidden"))return d=!0,i(),!1}),$(".notification-count").text($(".admin_info_box").length),$(".admin_info_box").length>0&&$(".notification-count").removeClass("hidden"),$(window).on("scroll",e),$(".admin_info_box_button").on("click",function(){return clearTimeout(a),d=!1,s.hasClass("active")?o():i(),!1}),s.on("mousemove mouseenter",function(){clearTimeout(a)}).on("mouseleave",function(){d===!0&&(a=setTimeout(function(){o()},1e3))}).on("click","a",function(){if($(this).hasClass("ajax")){d=!1;var n=$(this).closest(".admin_info_box"),i=$(this).attr("rel");return"hide_info_box"!==i&&n.addClass("progress"),$.get($(this).attr("href")).done(function(e){switch(i){case"clear_cache":n.removeClass("info warning progress"),e.length<500?(n.find(".info_text").html(e),n.find('a[rel="clear_cache"]').hide(),n.addClass("success"),setTimeout(function(){0===$(".admin_info_box").not(".hidden").length&&$(".admin_info_box_button").removeClass("active"),o(),setTimeout(function(){n.addClass("hidden").remove()},500)},2e3),$(".notification-count").text(parseInt($(".notification-count").text())-1),"0"===$(".notification-count").text()&&$(".notification-count").addClass("hidden")):(n.find(".info_text").html(jse.core.lang.translate("ERROR_SESSION_EXPIRED","admin_info_boxes")),n.addClass("error"));break;case"hide_info_box":$(".show_all_info_boxes").prop("checked",!1),n.slideUp(500,function(){$(this).addClass("hidden"),t(),0===$(".admin_info_box").not(".hidden").length&&$(".admin_info_box_button").removeClass("active")}),1===$(".admin_info_box:visible").length&&o();break;case"remove_info_box":n.slideUp(500,function(){$(this).addClass("hidden"),0===$(".admin_info_box").not(".hidden").length&&$(".admin_info_box_button").removeClass("active"),n.remove()}),1===$(".admin_info_box:visible").length&&o()}}).fail(function(i){n.removeClass("info warning progress").addClass("error"),n.find(".info_text").html(i)}),!1}if($(this).hasClass("target_blank")){var e;return e=window.open($(this).attr("href")),e.focus(),!1}return!0}),$(".show_all_info_boxes").on("click",function(){$(".show_all_info_boxes").prop("checked")?($(".no_messages").hide(),$(".admin_info_box.hidden").show()):(0===$(".admin_info_box").not(".hidden").length&&$(".no_messages").show(),$(".admin_info_box.hidden").hide())})}function i(){e(),t(),s.show().addClass("active"),$(".admin_info_box:visible").each(function(){$(this).hasClass("read")||$(this).hasClass("hidden")||$.ajax({url:"request_port.php",data:{module:"AdminInfobox",action:"set_status_read",id:$(this).find(".admin_info_box_id").text(),XTCsid:session_id}})}),d===!0&&(a=setTimeout(function(){o()},5e3))}function o(){s.removeClass("active")}function e(){s.css("top",s.height()*-1)}function t(){var n=!1;$(".admin_info_box.hidden").length>0?($(".show_all").css("display","block"),n=!0):$(".show_all").css("display","none"),0===$(".admin_info_box").not(".hidden").length&&s.find(".no_messages").show()}var s,a,d=!1;$.ajax({url:"request_port.php",data:{module:"LoadAdminInfoBoxes",XTCsid:session_id}}).done(function(i){$("body").append(i),s=$("#admin_info_wrapper"),1===s.length&&n()})});